(function ($) {
    let lastScrollPosition = 0; $(document).ready(function () { handlePreloader(); setupBackgroundImages(); initMobileNavigation(); initImageSwiper(); initTypedJs(); initPreferedLanguage(); positionBalls(); initMailSender(); initCursorTrail(); updateSocialVisibility(); initVantaBackground(); updateActiveMenuSectionOnScroll(); setupCvDownloadListener(); $(window).on('scroll', handleHeaderVisibilityOnScroll); window.addEventListener("scroll", toggleHeaderScrolledClass); window.addEventListener('scroll', updateActiveMenuSectionOnScroll); $(window).on('resize', updateSocialVisibility) }); $(window).on('load', function () { initPortfolioFilter() }); function handlePreloader() { $(".loader").fadeOut(); $("#preloder").delay(200).fadeOut("slow") }
    function initPreferedLanguage() {var preferedLanguage = window.localStorage.getItem("PREFERED_LANGUAGE");if (!preferedLanguage) {preferedLanguage = "EN";window.localStorage.setItem("PREFERED_LANGUAGE", preferedLanguage);} }
    function handleHeaderVisibilityOnScroll() {
        const currentScroll = window.pageYOffset; if (currentScroll > lastScrollPosition) { $('.header').fadeOut(400) } else { $('.header').fadeIn(600) }
        lastScrollPosition = currentScroll
    }
    function toggleHeaderScrolledClass() { const header = document.querySelector(".header"); if (header) { if (window.scrollY > 20) { header.classList.add("scrolled") } else { header.classList.remove("scrolled") } } }
    function setupBackgroundImages() { $('.set-bg').each(function () { const bg = $(this).data('setbg'); if (bg) { $(this).css('background-image', 'url(' + bg + ')') } }) }
    function initPortfolioFilter() { $('.portfolio__filter li').on('click', function () { $('.portfolio__filter li').removeClass('active'); $(this).addClass('active') }); if ($('.portfolio__gallery').length > 0 && typeof mixitup !== 'undefined') { const containerEl = document.querySelector('.portfolio__gallery'); mixitup(containerEl) } }
    function initMobileNavigation() { const { selected, unselected } = getCurrentFlags(); if ($(".mobile-menu").length > 0 && $.fn.slicknav) { $(".mobile-menu").slicknav({ prependTo: '#mobile-menu-wrap', allowParentLinks: !0, languageSelectorHtml: createLanguageDropdown(selected, unselected, 1) }); attachDropdownEvents('language-dropdown-1', 'dropdown-menu-1') } }
    function initImageSwiper() { if (typeof Swiper !== 'undefined' && document.querySelector(".mySwiper")) { new Swiper(".mySwiper", { effect: "cards", grabCursor: !0, initialSlide: 1, cardsEffect: { perSlideOffset: 10, perSlideRotate: 2, }, }) } }
    function initTypedJs() { const selectTyped = document.querySelector('.typed'); if (typeof Typed !== 'undefined' && selectTyped) { let typed_strings = i18nUtil.getTranslation('hero_typed_items').split(","); if (typed_strings) { new Typed('.typed', { strings: typed_strings, loop: !0, typeSpeed: 80, backSpeed: 50, backDelay: 2000 }) } } }
    function positionBalls() { const balls = document.querySelectorAll(".ball"); const positions = [{ x: -12, y: -18, size: 16 }, { x: 98, y: 80, size: 16 }, { x: -12, y: 0, size: 16 }, { x: 70, y: -15, size: 12 }, { x: -10, y: -40, size: 13 }, { x: 92, y: -40, size: 15 }, { x: -12, y: -40, size: 16 }, { x: 90, y: -20, size: 15 }, { x: -12, y: -40, size: 15 },]; balls.forEach((ball, index) => { if (positions[index]) { const { x, y, size } = positions[index]; ball.style.left = `${x}%`; ball.style.top = `${y}%`; ball.style.width = `${size}vw`; ball.style.height = `${size}vw`; ball.style.minWidth = "30px"; ball.style.minHeight = "30px" } }) }
    function initMailSender() { const form = document.getElementById('contact-form'); if (!form) return; const messages = { success: { en: "üéâ Your message has been sent successfully! I'll get back to you soon.", fr: "üéâ Votre message a bien √©t√© envoy√© ! Je vous r√©pondrai bient√¥t." }, error: { en: `‚ö†Ô∏è Oops! Message failed to send. Please try again or email me directly <a href="mailto:mickaelrakotonarivo@gmail.com" style="color: white; text-decoration: underline; font-weight: bold;">here</a>`, fr: `‚ö†Ô∏è Oups ! L'envoi du message a √©chou√©. Veuillez r√©essayer ou m'envoyer un email directement <a href="mailto:mickaelrakotonarivo@gmail.com" style="color: white; text-decoration: underline; font-weight: bold;">ici</a>`, } }; const isEnglish = localStorage.getItem('PREFERED_LANGUAGE') === "EN"; const successMessage = isEnglish ? messages.success.en : messages.success.fr; const errorMessage = isEnglish ? messages.error.en : messages.error.fr; form.addEventListener('submit', (e) => { e.preventDefault(); $("#send-message-button").attr("disabled", !0); $("#sending-button-text").text("Sending..."); $(".second").hide(); const name = document.getElementById('name').value; const email = document.getElementById('email').value; const phone = document.getElementById('phone').value; const message = document.getElementById('message').value; const mailConfig = { userId: 'eqWIHcTZUiGnh6cH5', templateId: 'template_ue7t2rb', serviceId: 'service_2f6kux5', templateParams: { to_name: 'Dylan', to_email: 'mickaelrakotonarivo@gmail.com', from_name: name, from_email: email, from_phone: phone, message: message, } }; emailjs.send(mailConfig.serviceId, mailConfig.templateId, mailConfig.templateParams, mailConfig.userId).then(() => { $("#send-message-button").attr("disabled", !1); $("#sending-button-text").text("Send Message"); $(".second").show(); Toastify({ text: successMessage, duration: 5000, gravity: "bottom", position: "right", className: "toast-success", stopOnFocus: !0, style: { background: "#020828", zIndex: 9999, marginBottom: '50px', boxShadow: "0 4px 24px 0 rgba(2, 8, 70, 0.2)" } }).showToast(); form.reset() }).catch((error) => { console.error('Failed to send email:', error); $("#send-message-button").attr("disabled", !1); $("#sending-button-text").text("Send Message"); $(".second").show(); Toastify({ text: errorMessage, duration: 5000, gravity: "bottom", position: "right", className: "toast-error", stopOnFocus: !0, escapeMarkup: !1, style: { background: "#020828", zIndex: 9999, marginBottom: '50px', boxShadow: "0 4px 24px 0 rgba(2, 8, 70, 0.2)" } }).showToast() }) }) }
    function updateActiveMenuSectionOnScroll() { const links = document.querySelectorAll('#navigation li a'); if (links.length === 0) return; const scrollPosition = window.scrollY; const sections = ['hero', 'resume', 'services', 'skills', 'projects', 'contact']; sections.forEach((sectionId, index) => { const section = document.getElementById(sectionId); if (!section) return; const sectionTop = section.offsetTop; const sectionBottom = sectionTop + section.offsetHeight; if (scrollPosition >= (sectionTop - 500) && scrollPosition < sectionBottom) { links.forEach((link) => link.parentElement.classList.remove('active')); if (links[index]) links[index].parentElement.classList.add('active'); } }) }
    function setupCvDownloadListener() { $("#btn-download-cv").on('click', function () { window.open('/assets/pdf/CV-Dylan-RAKOTONARIVO.pdf', '_blank') }) }
    function initCursorTrail() { let trail = []; const trailLength = 20; document.addEventListener('mousemove', (e) => { const cursor = document.createElement('div'); cursor.classList.add('cursor'); document.body.appendChild(cursor); cursor.style.left = `${e.pageX + 20}px`; cursor.style.top = `${e.pageY + 20}px`; trail.push(cursor); if (trail.length > trailLength) { const oldCursor = trail.shift(); if (oldCursor) oldCursor.remove(); } }) }
    function updateSocialVisibility() { if ($(".slicknav_menu").css("display") === "none") { $("#footer__nav__social").addClass("d-none") } else { $("#footer__nav__social").removeClass("d-none") } }
    function initVantaBackground() { if (typeof VANTA !== 'undefined' && typeof VANTA.GLOBE === 'function' && $('#hero').length > 0) { VANTA.GLOBE({ el: "#hero", backgroundColor: "#000116", color: "#020860", color2: "#000116", mouseControls: !0, touchControls: !0, gyroControls: !1, minHeight: 200.00, minWidth: 200.00, scale: 1.00, scaleMobile: 1.00 }) } }
})(jQuery)