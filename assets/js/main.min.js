(function ($) {
    let scene, camera, renderer, controls, composer; let particleSystem, particlePositions, particleVelocities; let particleCount = 2000; let params; let clock = new THREE.Clock(); let stopAnimation = !1; let shouldDecreaseExpansion = !1; $(document).ready(function () {
        handlePreloader(); animateText(() => {
            try { init(); animate() } catch (error) { console.error(error) }
            $("#singularity").hide(); setTimeout(() => { $("#typed-text").fadeOut(600); $(".typed-cursor").fadeOut(600) }, 3000); setTimeout(() => { launchFinalAnimation() }, 1600); setTimeout(() => { launchShootingStar(); shouldDecreaseExpansion = !0 }, 4500)
        }); $('#cta-button').on('click', animateRocket)
    }); function handlePreloader() { $(".loader").fadeOut(); $("#preloder").delay(200).fadeOut("slow") }
    function init() { scene = new THREE.Scene(); camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000); camera.position.set(0, 0, 200); renderer = new THREE.WebGLRenderer({ antialias: !0 }); renderer.setSize(window.innerWidth, window.innerHeight); renderer.setPixelRatio(window.devicePixelRatio); renderer.shadowMap.enabled = !0; renderer.setClearColor(0x000110); document.body.appendChild(renderer.domElement); controls = new THREE.OrbitControls(camera, renderer.domElement); controls.enableDamping = !0; controls.dampingFactor = 0.05; const ambientLight = new THREE.AmbientLight(0x404040, 1.5); scene.add(ambientLight); const pointLight = new THREE.PointLight(0xffffff, 2, 1000); pointLight.position.set(0, 0, 0); pointLight.castShadow = !0; scene.add(pointLight); composer = new THREE.EffectComposer(renderer); let renderPass = new THREE.RenderPass(scene, camera); composer.addPass(renderPass); let bloomPass = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85); bloomPass.threshold = 0; bloomPass.strength = 0; bloomPass.radius = 0; composer.addPass(bloomPass); createParticleSystem(); setupGUI(); window.addEventListener("resize", onWindowResize, !1) }
    function createParticleSystem() {
        const geometry = new THREE.BufferGeometry(); particlePositions = new Float32Array(particleCount * 3); particleVelocities = new Float32Array(particleCount * 3); for (let i = 0; i < particleCount; i++) { particlePositions[i * 3] = 0; particlePositions[i * 3 + 1] = 0; particlePositions[i * 3 + 2] = 0; let theta = Math.random() * 2 * Math.PI; let phi = Math.acos(Math.random() * 2 - 1); let speed = Math.random() * 0.5 + 0.5; particleVelocities[i * 3] = speed * Math.sin(phi) * Math.cos(theta); particleVelocities[i * 3 + 1] = speed * Math.sin(phi) * Math.sin(theta); particleVelocities[i * 3 + 2] = speed * Math.cos(phi) }
        geometry.setAttribute("position", new THREE.BufferAttribute(particlePositions, 3)); const sprite = generateSprite(); const material = new THREE.PointsMaterial({ size: 2, map: sprite, blending: THREE.AdditiveBlending, depthTest: !1, transparent: !0, opacity: 0.8, color: 0xffffff, }); particleSystem = new THREE.Points(geometry, material); scene.add(particleSystem)
    }
    function generateSprite() { const canvas = document.createElement("canvas"); canvas.width = 64; canvas.height = 64; const context = canvas.getContext("2d"); const gradient = context.createRadialGradient(32, 32, 0, 32, 32, 32); gradient.addColorStop(0, "rgba(255, 255, 255, 1)"); gradient.addColorStop(0.2, "rgba(255, 255, 255, 1)"); gradient.addColorStop(0.4, "rgba(40, 73, 206, 0.8)"); gradient.addColorStop(1, "#000116"); context.fillStyle = gradient; context.fillRect(0, 0, 64, 64); const texture = new THREE.CanvasTexture(canvas); return texture }
    function setupGUI() { params = { expansionSpeed: 100, particleSize: 2, bloomStrength: 2, bloomRadius: 0.5, bloomThreshold: 0, } }
    function onWindowResize() { camera.aspect = window.innerWidth / window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); composer.setSize(window.innerWidth, window.innerHeight) }
    function animate() {
        if (!stopAnimation) requestAnimationFrame(animate); const delta = clock.getDelta(); if (shouldDecreaseExpansion && params.expansionSpeed > 5) { if (params.expansionSpeed > 10) { params.expansionSpeed -= 0.4 } }
        updateParticles(delta); controls.update(); composer.render(delta)
    }
    function updateParticles(delta) {
        const positions = particleSystem.geometry.attributes.position.array; for (let i = 0; i < particleCount; i++) { let index = i * 3; positions[index] += particleVelocities[index] * params.expansionSpeed * delta; positions[index + 1] += particleVelocities[index + 1] * params.expansionSpeed * delta; positions[index + 2] += particleVelocities[index + 2] * params.expansionSpeed * delta }
        particleSystem.geometry.attributes.position.needsUpdate = !0
    }
    function animateText(startAnimation) {
        const options = { strings: i18nUtil.getTranslation('story_tell').split(","), typeSpeed: 15, backSpeed: 15, loop: !1, showCursor: !0, backDelay: 2000, cursorChar: "|", autoInsertCss: !0, onComplete: function (self) { startAnimation() } }; const typed = new Typed("#typed-text", options)
    }
    function launchFinalAnimation() { $("#final-text-container *").not("hr").not("#description-text").css({ display: 'none', opacity: 0 }).delay(1000).fadeIn(1000, function () { $(this).animate({ opacity: 1 }, 1000); $("#final-button").addClass('fade-up'); $("#final-text").addClass('fade-down') }); $("#final-text-container hr").css({ width: '0%' }).delay(1400).fadeIn(500, function () { $(this).animate({ width: '80%', }, 500) }); $("#final-text-container #description-text").css({ display: 'none', opacity: 0 }).delay(1800).fadeIn(1000, function () { $(this).animate({ opacity: 1 }, 500) }) }
    function launchShootingStar() {
        const section = document.querySelector('#shooting-star'); function getRandomTop(min, max) { return Math.floor(Math.random() * max) + min }
        function getRandomDelay() { return (Math.random() * 2).toFixed(1) }
        function getRandomDuration() { return Math.floor(Math.random() * (10 - 6 + 1)) + 6 }
        for (let i = 1; i <= 10; i++) { const span = document.createElement('span'); section.appendChild(span) }
        $("#shooting-star").fadeIn(1000)
    }
    function animateRocket() {
        setTimeout(() => {
            window.location.pathname = "/portfolio.html"
        }, 3000); $(this).addClass('launch'); let trail = []; const trailLength = 20; const $image = $(".launch img"); const $followImage = $('<img>'); $followImage.css({ position: 'absolute', transform: 'rotate(45deg)', height: '30px' }); $followImage.attr('src', '/assets/img/cursors/rocket-launch.png'); $('body').append($followImage); function updateTrail() {
            const trace = document.createElement('div'); trace.classList.add('trace'); document.body.appendChild(trace); const offset = $image.offset(); trace.style.left = `${offset.left + 20}px`; trace.style.top = `${offset.top + 32}px`; trail.push(trace); if (trail.length > trailLength) { const oldTrace = trail.shift(); oldTrace.remove() }
            $followImage.css({ left: `${offset.left + 7}px`, top: `${offset.top}px` })
        }
        function animate() { updateTrail(); requestAnimationFrame(animate) }
        stopRobotAnimation(); animate()
    }
    function stopRobotAnimation() { const $modelViewer = $('model-viewer'); const modelViewer = $modelViewer[0]; if (modelViewer) { modelViewer.timeScale = 1 } }
})(jQuery)